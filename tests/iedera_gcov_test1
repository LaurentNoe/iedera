#!/bin/sh

# (1) help file
./iedera_gcov -h && exit 99

# (2) classical spaced seeds with "full enum", "random", "hillclimbing", and "multihit/coverage"
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -l 16 || exit 99
./iedera_gcov -spaced -BSymbols 01 -n 2 -w 11,11 -s 18,20 -r 10    -z 1 || exit 99
./iedera_gcov -spaced -BSymbols 01 -n 2 -w 11,11 -s 18,20 -r 10 -k -z 1 || exit 99
./iedera_gcov -spaced -BSymbols 01 -y 2 -r 10 -k -z 1 || exit 99
./iedera_gcov -spaced -BSymbols 01 -g 2 -r 10 -k -z 1 || exit 99

# (3) classical spaced seeds with one shot "-mx" exclude tests combined with "-ll" window tests:
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 -llf max || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 -llf avg || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 -llf med || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -g 2 -m "11111011111" -mx "1111111111" -mxy 2 -ll 32 -llf avg -p || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -p -y SPEARMAN || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -y 2 -m "11111011111" -p -y PEARSON || exit 99

# (4) classical spaced seeds with some lossless tests [FIXME ? see with -mx ?]
./iedera_gcov -spaced -BSymbols 01 -l 25 -w 12,12 -s 15,15 -L 1,0 -X 2 -m "111111000111111" -r 10 -k || exit 99
./iedera_gcov -spaced -BSymbols 01 -l 25 -w 12,12 -s 19,19 -L 1,0 -X 2 -m "1110100111010011101" || exit 99
#./iedera_gcov -spaced -BSymbols 01 -l 32 -w 12,12 -s 15,15 -L 1,0 -X 2 -m "1110100111010011101" -ll 25 #OUPS ?
./iedera_gcov -spaced -BSymbols 01 -l 50 -w 12,12 -L 1,0 -X 5 -m "1010100010000010101000100000101010001" || exit 99
./iedera_gcov -spaced -BSymbols 01 -l 50 -w 12,12 -L 1,0 -X 2 -m "1010100010000010101000100000101010001:1/2"  -p || exit 99

# (5) classical spaced seeds with cycle
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1/2" -mx "1111111111:1/2" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1,2/2" -mx "1111111111:1,2/2" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111" -mx "1111111111" || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1,2/2" -mx "1111111111:1,2/2" -mxy 2 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1,2/2" -mx "1111111111:1,2/2" -mxy 10 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1,2/2" -mx "1111111111:1,2/2" -mxy 10 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -m "11111011111:1,2/2" -mx "1111111111:1,2/2" -mxy 2 -r 10 -k  || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -c 3 -q 2 -z 1
./iedera_gcov -spaced -BSymbols 01 -w 10,10 -s 10,11 -n 2 -c 3 -q 2 -z 30

# (6) classical spaced seeds with command-line "-x" "-f" "-b" "-a" "-M"
./iedera_gcov -A 2 -B 2 -M "{{1,1},{0,1}}" -BSymbols 01 -w 5,5 -s 5,9 -b 0.75,0.25 -f 0.3,0.7         -r 10 -k -x -a 0.05 || exit 99
./iedera_gcov -A 2 -B 2 -M "{{1,1},{0,1}}" -BSymbols 01 -w 5,5 -s 5,9 -b 0.75,0.25 -f 0.1,0.3,0.2,0.4 -r 10 -k -x -a 0.05 || exit 99

# (7) classical spaced seeds with homogeneous
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -m "111011" -l 16          || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -m "111011" -l 16 -u -1,10 || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -m "111011" -l 16 -u -1,2  || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -m "111011" -l 16 -u -1,1  || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 5,5 -s 5,8 -m "111011" -l 16 -u -2,1  || exit 99


# (8) dominant with input output
./iedera_gcov -spaced -BSymbols 01 -w 11,11 -s 11,11 -p -o _fileout_dominant_ || exit 99
./iedera_gcov -spaced -BSymbols 01 -w 11,11 -s 18,18 -p -e _fileout_dominant_ -o _fileout_dominant_ -m "111011001010010111" || exit 99
